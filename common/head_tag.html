<script type="text/discourse-plugin" version="0.8.24">
api.decorateWidget('header-buttons:after', helper => {
    const showExtraInfo = helper.attrs.topic;
    
    if(!showExtraInfo) {
        return helper.h('a.theme-switcherWrapper', [
            helper.h('a.theme-switcher--light', {
                text: 'Light',
                title: 'Change the Theme Color to Light'
            }),
            helper.h('input.theme-switcherBox.theme-switcher #theme-switcher', {
                type:'checkbox'
            }),
            helper.h('label.theme-switcherLabel', {
            'attributes': {
                'for': 'theme-switcher'
            }
            }),
            helper.h('a.theme-switcher--dark', {
                text:'Dark',
                title: 'Change the Theme Color to Dark'
            })
        ]);
    }
});

	$(document).ajaxComplete(function() {
		$(".theme-switcher").on('change', function() {
			if ($(this).is(':checked')) {
				$('html').addClass('dark');
				localStorage.setItem('theme', 'dark');
				$('.theme-switcher').prop('checked', true);
			}
			else {
				$('html').removeClass('dark');
				localStorage.removeItem('theme', 'dark');
				$('.theme-switcher').prop('checked', false);
			}
		});
	});

	$( document ).ready(function() {
		$(window).scroll(function() {

			if ($('.contents').find('.extra-info-wrapper').length > 0) {
				// Scrolled Top
			} else {
				if ($('html').hasClass('dark')) {
					$('.theme-switcher').prop('checked', true);

				} else {
					$('.theme-switcher').prop('checked', false);
				}
			}

			$(".theme-switcher").on('change', function() {
				if ($(this).is(':checked')) {
					$('html').addClass('dark');
					localStorage.setItem('theme', 'dark');
					$('.theme-switcher').prop('checked', true);
				}
				else {
					$('html').removeClass('dark');
					localStorage.removeItem('theme', 'dark');
					$('.theme-switcher').prop('checked', false);
				}
			});

			$('.theme-switcher--light').on('click', function() {
				$('html').removeClass('dark');
				$('.theme-switcher').prop('checked', false);

				if ($('html').hasClass('dark')) {
					localStorage.setItem('theme', 'dark');

				} else {
					localStorage.setItem('theme', 'light');
				}
			});

			$('.theme-switcher--dark').on('click', function() {
				$('html').addClass('dark');
				$('.theme-switcher').prop('checked', true);

				if ($('html').hasClass('dark')) {
					localStorage.setItem('theme', 'dark');

				} else {
					localStorage.setItem('theme', 'light');
				}
			});
		});

		$(".theme-switcher").on('change', function() {
			if ($(this).is(':checked')) {
				$('html').addClass('dark');
				localStorage.setItem('theme', 'dark');
				$('.theme-switcher').prop('checked', true);
			}
			else {
				$('html').removeClass('dark');
				localStorage.removeItem('theme', 'dark');
				$('.theme-switcher').prop('checked', false);
			}
		});

		$('.theme-switcher--light').on('click', function() {
			$('html').removeClass('dark');
			$('.theme-switcher').prop('checked', false);

			if ($('html').hasClass('dark')) {
				localStorage.setItem('theme', 'dark');

			}else{
				localStorage.setItem('theme', 'light');
			}
		});

		$('.theme-switcher--dark').on('click', function() {
			$('html').addClass('dark');
			$('.theme-switcher').prop('checked', true);

			if ($('html').hasClass('dark')) {
				localStorage.setItem('theme', 'dark');
			}else{
				localStorage.setItem('theme', 'light');
			}
		});


		if (typeof(localStorage) !== "undefined") {
			if (localStorage.getItem("theme") === 'dark' || localStorage.getItem("theme") === null && !settings.default_light) {
				$('html').addClass('dark');
				$('.theme-switcher').prop('checked', true);
			} else {
				$('html').removeClass('dark');
				$('.theme-switcher').prop('checked', false);
				localStorage.removeItem('theme', 'dark');
			}
		} else {
		// Sorry! No Web Storage support..
		console.log('Upgrade to a better browser! Really!')
		}
	});

</script>